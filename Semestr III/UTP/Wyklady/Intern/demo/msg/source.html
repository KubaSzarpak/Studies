<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html lang="pl">
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
  <title>Kod programu</title>
  <style type="text/css" media="screen">
  <!--
   pre { background-color: #fffff7; color: black; display: block; white-space: pre; border: 1px solid #800000; padding:2% }
   -->
  </style>
</head>
<body>
<h2>Plik Info_en_GB.java</h2></br>
<pre>
package msg;

import java.util.*;
public class Info_en_GB extends ListResourceBundle {

   public Object[][] getContents() {
     return contents;
   }

   private Object[][] contents = {
      { "english", "English" },
      { "polish", "Polish" },
      {  "enterData", "Withdrawal" },
      { "report",
         "At {0,time} on {0,date} value of {1,number,currency} was withdrawed" },
      { "parseError", "Invalid value format: {0}" },
      { "exceedError", "Total ammount {0,number,currency} exceeded" },
   };

}


</pre>
<h2>Plik Info_pl_PL.java</h2></br>
<pre>
package msg;

import java.util.*;
public class Info_pl_PL extends ListResourceBundle {

   public Object[][] getContents() {
     return contents;
   }

   private Object[][] contents = {
     {  "english", "Angielski" },
     {  "polish", "Polski" },
     {  "enterData", "Wyp쓰ta" },
     {  "report", "Dnia {0,date} o godzinie {0,time}" +
                  " wyp쓰cono {1,number,currency}" },
     {  "parseError", "Nieprawid쓾wy format warto띾i do wyp쓰ty {0}" },
     {  "exceedError", "Mo쯟iwa suma wyp쓰t {0,number,currency}" +
                     " zosta쓰 przekroczona" },
   };

}


</pre>
<h2>Plik Msg1.java</h2></br>
<pre>
package msg;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.text.*;
import java.util.*;
import java.beans.*;

@SuppressWarnings("serial")
public class Msg1 extends JFrame  {

  private JPanel panel = new JPanel();
  private JTextArea log = new JTextArea(20, 40);
  private String parseErrorPattern;
  private String reportPattern;
  private String exceedPattern;
  private double limit = 1000;
  private double sum;

  public Msg1() {
    panel.add(new JLabel());
    final JTextField tf = new JTextField(10);
    panel.add(tf);
    JButton b = new JButton();
    b.setActionCommand("pl_PL");
    b.addActionListener(locChanger);
    panel.add(b);
    b = new JButton();
    b.setActionCommand("en_GB");
    b.addActionListener(locChanger);
    panel.add(b);
    add(panel, "North");

    localize(Locale.getDefault());

    
    add(log);

    tf.addActionListener( new ActionListener() {
          public void actionPerformed(ActionEvent e) {
            ParsePosition p = new ParsePosition(0);
            String txtNum = tf.getText().trim();
            Number val = NumberFormat.getInstance().parse(txtNum, p);
            String out;
            if (p.getIndex() != txtNum.length())
              out = MessageFormat.format(parseErrorPattern, txtNum);
            else if (sum + val.doubleValue() > limit)
              out = MessageFormat.format(exceedPattern, limit);
            else {
              sum += val.doubleValue();
              Date date = Calendar.getInstance().getTime();
              out = MessageFormat.format(reportPattern, date, val);
            }
            log.append(out+'\n');
          }
       });
    
    // Inicjacja font雕
    Font f = new Font("Dialog", Font.PLAIN, 18);
    log.setFont(f);
    for (Component c : panel.getComponents()) c.setFont(f);

    setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    pack();
    setLocationRelativeTo(null);
    setVisible(true);
  }

  private void localize(Locale loc) {
    limit = 1000;
    sum = 0;
    log.setText("");
    Locale.setDefault(loc);
    ResourceBundle info =
                   ResourceBundle.getBundle("msg.Info");
    String[] txt = {
                       info.getString("enterData"),
                       "",
                       info.getString("polish"),
                       info.getString("english"),
                   };
    Component[] c = panel.getComponents();
    for (int i=0; i&lt;c.length; i++) {
      Statement stmt = new Statement(c[i], "setText",
                            new Object[] { txt[i] } );
      try {
        stmt.execute();
      } catch(Exception exc) { exc.printStackTrace(); }
    }
    panel.invalidate();
    parseErrorPattern = info.getString("parseError");
    reportPattern = info.getString("report");
    exceedPattern = info.getString("exceedError");
  }


  ActionListener locChanger =  new ActionListener() {
    public void actionPerformed(ActionEvent e) {
      String symloc = e.getActionCommand();
      String[] locArg = symloc.split("_");
      localize(new Locale(locArg[0], locArg[1]));
    }
  };

  public static void main(String[] args) {
     SwingUtilities.invokeLater(new Runnable() {
      public void run() {
        new Msg1();
      }
    });
  }

}
</pre>

</body>
</html>
     
